{%- import 'macros.j2' as macros -%}
<!-- This file is automatically generated. Don't edit it manually! -->
---
mapped_pages:
  - https://www.elastic.co/guide/en/ecs/current/ecs-{{ fieldset['name'] }}.html
applies_to:
  stack: all
  serverless: all
---

{# Title & Description -#}
# {{ fieldset['title'] }} fields [ecs-{{ fieldset['name'] }}]

{{ fieldset['description']|replace("\n", "\n\n") }}

{# Fieldset label beta header -#}
{% if fieldset['beta'] -%}

> **Beta:** {{ fieldset['beta'] }}

{% endif -%}

{# Field Details Table Header -#}
## {{ fieldset['title'] }} field details [_{{ fieldset['title'] | lower | replace(" ", "_") }}_field_details]

| Field | Description | Level |
| --- | --- | --- |
{# Iterate through each field in the set -#}
{% for field in sorted_fields -%}
{% if 'original_fieldset' not in field -%}
| $$$field-{{ field['dashed_name'] }}$$$[{{ field['flat_name'] }}](#field-{{ field['dashed_name'] }}) |
{% if field['beta'] -%}
beta: {{ field['beta'] }}
{{ field['description']|replace("\n", "<br>") }}<br><br>
{%- else -%}
{{ field['description']|replace("\n", "<br>") }}<br><br>
{%- endif %}
{% if field['expected_values'] %}
Expected values for this field:<br><br>
{% for val in field['expected_values'] %}
* `{{ val }}`<br>
{%- endfor %}
{%- endif %}
type: {{ field['type'] }}<br><br>
{% if 'multi_fields' in field -%}
Multi-fields:<br><br>
{% for mf in field['multi_fields'] -%}
 {{ mf['flat_name'] }} (type: {{ mf['type'] }})<br>
{% endfor %}
{% endif %}
{% if 'array' in field['normalize'] -%}
Note: This field should contain an array of values.<br>
{% endif %}
{% if 'allowed_values' in field %}
**Important:** The field value must be one of the following:<br><br>
{{ field['allowed_value_names']|join(', ') }}
<br><br>To learn more about when to use which value, visit the page [allowed values for {{ field['flat_name'] }}](/reference/ecs-allowed-values-{{ field['dashed_name'] }}.md)<br>
{% elif 'example' in field -%}
example: `{{ field['example'] }}`<br>
{%- endif %}
{% if field['otel'] -%}
{%- for otel in field['otel'] %}
{{ macros.otel_badge }} {{ macros.otel_relation_badge(otel) }} {{ macros.otel_link(field, otel) }}
{%- if 'note' in otel %}
**Note:** {{ otel['note'] }}
{%- endif %}
{%- endfor %}
{%- endif %}
 | {{ field['level'] }} |
{% endif %}
{% endfor %}

{# field reuse section -#}
{% if 'reusable' in fieldset -%}

## Field Reuse [_field_reuse]

the `{{ fieldset['name'] }}` fields are expected to be nested at:

{% for entry in sorted_reuse_fields %}
* `{{ entry }}`
{% endfor %}

{% if 'top_level' in fieldset['reusable'] and fieldset['reusable']['top_level'] -%}

Note also that the `{{ fieldset['name'] }}` fields may be used directly at the root of the events.

{% else -%}

Note also that the `{{ fieldset['name'] }}` fields are not expected to be used directly at the root of the events.

{%- endif %}
{% endif %}

{% if 'nestings' in fieldset -%}

### field sets that can be nested under {{ fieldset['title'] }} [ecs-{{ fieldset['hashed_name'] }}-nestings]

| location | field set | description |
|---|---|---|

{% for entry in render_nestings_reuse_section -%}
| `{{ entry['flat_nesting'] }}` |
| [{{ entry['name'] }}](#ecs-{{ entry['name'] }}) |

{% if entry['beta'] -%}
**beta:** {{ entry['beta'] }}
{{ entry['short'] }}
{%- else %}
{{ entry['short'] }}
{%- endif %}

{% if entry['normalize'] and 'array' in entry['normalize'] -%}

**note:** this reuse should contain an array of {{ entry['name'] }} field set objects.

{% endif -%}

{% endfor -%}

{% endif %}

{%- if usage_doc %}

### {{ fieldset['title'] }} field usage

for usage and examples of the `{{ fieldset['name'] }}` fields, see [{{ fieldset['title'] }} fields usage and examples](#ecs-{{ fieldset['name']|replace("_", "-") }}-usage).

{% endif %}
